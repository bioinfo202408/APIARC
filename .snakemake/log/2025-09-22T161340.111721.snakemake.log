Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 5
Rules claiming more threads will be scaled down.
Job stats:
job                               count
------------------------------  -------
Motif_tf_Promoter                     1
Network_construction                  1
TF_motif_plot_down                    1
TF_motif_plot_up                      1
all                                   1
extr_down_gene_enriched_motifs        1
extr_up_gene_enriched_motifs          1
promoter_plot                         1
total                                 8

Select jobs to execute...

[Mon Sep 22 16:13:40 2025]
rule promoter_plot:
    input: data/INTEGRATEDPROJ/script/Promoter/config.yaml, data/CHIPPROJ/Macs2/group_matrix.txt
    output: data/INTEGRATEDPROJ/Promoter/mESC_18h_DOX_all_peaks.bed, data/INTEGRATEDPROJ/Promoter/mESC_12h_DOX_all_peaks.bed, data/INTEGRATEDPROJ/Promoter/mESC_18h_DOX_down_peaks.bed, data/INTEGRATEDPROJ/Promoter/mESC_12h_DOX_down_peaks.bed, data/INTEGRATEDPROJ/Promoter/mESC_18h_DOX_up_peaks.bed, data/INTEGRATEDPROJ/Promoter/mESC_12h_DOX_up_peaks.bed, data/INTEGRATEDPROJ/Promoter/RNA_ChIP_col_plot_same_direction.pdf, data/INTEGRATEDPROJ/Promoter/common_genes_volcano_plot.pdf, data/INTEGRATEDPROJ/Promoter/common_up_genes_venn_diagram.pdf, data/INTEGRATEDPROJ/Promoter/common_down_genes_venn_diagram.pdf, data/INTEGRATEDPROJ/Promoter/GO_enrich_common_gene.csv, data/INTEGRATEDPROJ/Promoter/KEGG_GSEA_common_gene.csv, data/INTEGRATEDPROJ/Promoter/KEGG_GSEA_Top10_Multipage.pdf
    jobid: 1
    reason: Missing output files: data/INTEGRATEDPROJ/Promoter/mESC_18h_DOX_down_peaks.bed, data/INTEGRATEDPROJ/Promoter/GO_enrich_common_gene.csv, data/INTEGRATEDPROJ/Promoter/mESC_12h_DOX_up_peaks.bed, data/INTEGRATEDPROJ/Promoter/mESC_12h_DOX_all_peaks.bed, data/INTEGRATEDPROJ/Promoter/mESC_18h_DOX_all_peaks.bed, data/INTEGRATEDPROJ/Promoter/mESC_12h_DOX_down_peaks.bed, data/INTEGRATEDPROJ/Promoter/KEGG_GSEA_common_gene.csv, data/INTEGRATEDPROJ/Promoter/mESC_18h_DOX_up_peaks.bed
    resources: tmpdir=/tmp

[Mon Sep 22 16:15:02 2025]
Finished job 1.
1 of 8 steps (12%) done
Select jobs to execute...

[Mon Sep 22 16:15:02 2025]
rule Network_construction:
    input: data/INTEGRATEDPROJ/Promoter/GO_enrich_common_gene.csv
    output: data/INTEGRATEDPROJ/Promoter/GO_network.graphml
    jobid: 7
    reason: Missing output files: data/INTEGRATEDPROJ/Promoter/GO_network.graphml; Input files updated by another job: data/INTEGRATEDPROJ/Promoter/GO_enrich_common_gene.csv
    resources: tmpdir=/tmp


[Mon Sep 22 16:15:02 2025]
rule Motif_tf_Promoter:
    input: data/INTEGRATEDPROJ/script/Promoter/config.yaml, data/CHIPPROJ/bam_bwfile/bambw_list.yaml, data/INTEGRATEDPROJ/Promoter/KEGG_GSEA_common_gene.csv
    output: data/INTEGRATEDPROJ/Promoter/Promoter_both_up_genes_target_seqs.fasta, data/INTEGRATEDPROJ/Promoter/Promoter_both_down_genes_target_seqs.fasta, data/INTEGRATEDPROJ/Promoter/TF_motif_network_up.txt, data/INTEGRATEDPROJ/Promoter/TF_motif_network_down.txt, data/INTEGRATEDPROJ/Promoter/TF_gene_mapping_up.txt, data/INTEGRATEDPROJ/Promoter/TF_gene_mapping_down.txt, data/INTEGRATEDPROJ/Promoter/Promoter_both_up_genes_matrix.gz, data/INTEGRATEDPROJ/Promoter/Promoter_both_up_genes_signal.tab, data/INTEGRATEDPROJ/Promoter/Promoter_both_down_genes_matrix.gz, data/INTEGRATEDPROJ/Promoter/Promoter_both_down_genes_signal.tab, data/INTEGRATEDPROJ/Promoter/Promoter_both_up_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Promoter/Promoter_both_down_genes_plotProfile.pdf
    jobid: 2
    reason: Missing output files: data/INTEGRATEDPROJ/Promoter/Promoter_both_down_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Promoter/Promoter_both_up_genes_plotProfile.pdf; Input files updated by another job: data/INTEGRATEDPROJ/Promoter/KEGG_GSEA_common_gene.csv
    resources: tmpdir=/tmp

[Mon Sep 22 16:15:05 2025]
Finished job 7.
2 of 8 steps (25%) done
[Mon Sep 22 16:21:59 2025]
Finished job 2.
3 of 8 steps (38%) done
Select jobs to execute...

[Mon Sep 22 16:21:59 2025]
rule extr_down_gene_enriched_motifs:
    input: data/INTEGRATEDPROJ/Promoter/Promoter_both_up_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Promoter/Promoter_both_down_genes_plotProfile.pdf
    output: data/INTEGRATEDPROJ/Promoter/Motif_result_down_list.txt
    jobid: 4
    reason: Missing output files: data/INTEGRATEDPROJ/Promoter/Motif_result_down_list.txt; Input files updated by another job: data/INTEGRATEDPROJ/Promoter/Promoter_both_down_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Promoter/Promoter_both_up_genes_plotProfile.pdf
    resources: tmpdir=/tmp


[Mon Sep 22 16:21:59 2025]
rule extr_up_gene_enriched_motifs:
    input: data/INTEGRATEDPROJ/Promoter/Promoter_both_up_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Promoter/Promoter_both_down_genes_plotProfile.pdf
    output: data/INTEGRATEDPROJ/Promoter/Motif_result_up_list.txt
    jobid: 3
    reason: Missing output files: data/INTEGRATEDPROJ/Promoter/Motif_result_up_list.txt; Input files updated by another job: data/INTEGRATEDPROJ/Promoter/Promoter_both_down_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Promoter/Promoter_both_up_genes_plotProfile.pdf
    resources: tmpdir=/tmp

[Mon Sep 22 16:22:01 2025]
Finished job 3.
4 of 8 steps (50%) done
Select jobs to execute...

[Mon Sep 22 16:22:01 2025]
rule TF_motif_plot_up:
    input: data/INTEGRATEDPROJ/Promoter/Motif_result_up_list.txt
    output: data/INTEGRATEDPROJ/Promoter/TF_up_gene_heatmap.pdf
    jobid: 5
    reason: Missing output files: data/INTEGRATEDPROJ/Promoter/TF_up_gene_heatmap.pdf; Input files updated by another job: data/INTEGRATEDPROJ/Promoter/Motif_result_up_list.txt
    resources: tmpdir=/tmp

[Mon Sep 22 16:22:01 2025]
Finished job 4.
5 of 8 steps (62%) done
Select jobs to execute...

[Mon Sep 22 16:22:01 2025]
rule TF_motif_plot_down:
    input: data/INTEGRATEDPROJ/Promoter/Motif_result_down_list.txt
    output: data/INTEGRATEDPROJ/Promoter/TF_down_gene_heatmap.pdf
    jobid: 6
    reason: Missing output files: data/INTEGRATEDPROJ/Promoter/TF_down_gene_heatmap.pdf; Input files updated by another job: data/INTEGRATEDPROJ/Promoter/Motif_result_down_list.txt
    resources: tmpdir=/tmp

[Mon Sep 22 16:22:05 2025]
Error in rule TF_motif_plot_down:
    jobid: 6
    input: data/INTEGRATEDPROJ/Promoter/Motif_result_down_list.txt
    output: data/INTEGRATEDPROJ/Promoter/TF_down_gene_heatmap.pdf
    shell:
        
        Rscript data/INTEGRATEDPROJ/script/Promoter/TF_motif_plot.R             --RNAseq data/RNAPROJ/DEG/DEG_result.csv             --TF_gene data/INTEGRATEDPROJ/Promoter/Motif_result_down_list.txt             --output data/INTEGRATEDPROJ/Promoter             --picture data/INTEGRATEDPROJ/Promoter/TF_down_gene_heatmap.pdf
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

[Mon Sep 22 16:22:07 2025]
Finished job 5.
6 of 8 steps (75%) done
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2025-09-22T161340.111721.snakemake.log
