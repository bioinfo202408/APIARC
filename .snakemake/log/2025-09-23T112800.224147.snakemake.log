Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 5
Rules claiming more threads will be scaled down.
Job stats:
job                               count
------------------------------  -------
Calculate_signal                      1
Computational_random_signal           1
Computational_signal                  1
Computational_ture_enh_signal         1
Enhancer_plot                         1
Motif_tf_Enhancer                     1
Network_construction                  1
TF_motif_plot_down                    1
TF_motif_plot_up                      1
all                                   1
calculate_eRNA_gene_distance          1
extr_down_gene_enriched_motifs        1
extr_up_gene_enriched_motifs          1
plot_ture_enh_signal                  1
total                                14

Select jobs to execute...

[Tue Sep 23 11:28:00 2025]
rule calculate_eRNA_gene_distance:
    input: data/INTEGRATEDPROJ/script/Promoter/config.yaml, data/INTEGRATEDPROJ/Promoter/file/mESC_18h_DOX_all_peaks.bed
    output: data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb.bed, data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb.bed
    jobid: 1
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb.bed, data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb.bed
    resources: tmpdir=/tmp

[Tue Sep 23 11:28:13 2025]
Finished job 1.
1 of 14 steps (7%) done
Select jobs to execute...

[Tue Sep 23 11:28:13 2025]
rule Computational_random_signal:
    input: data/CHIPPROJ/bam_bwfile/bambw_list.yaml, data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb.bed
    output: data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb_matrix.gz, data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb_signal.tab
    jobid: 2
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb_signal.tab; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb.bed
    resources: tmpdir=/tmp


[Tue Sep 23 11:28:13 2025]
rule Computational_signal:
    input: data/CHIPPROJ/bam_bwfile/bambw_list.yaml, data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb.bed
    output: data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb_matrix.gz, data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb_signal.tab
    jobid: 3
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb_signal.tab; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb.bed
    resources: tmpdir=/tmp

[Tue Sep 23 11:35:27 2025]
Finished job 2.
2 of 14 steps (14%) done
[Tue Sep 23 11:35:45 2025]
Finished job 3.
3 of 14 steps (21%) done
Select jobs to execute...

[Tue Sep 23 11:35:45 2025]
rule Calculate_signal:
    input: data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb_signal.tab, data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb_signal.tab
    output: data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb.bed
    jobid: 4
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb.bed; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb_signal.tab, data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb_signal.tab
    resources: tmpdir=/tmp

[Tue Sep 23 11:37:00 2025]
Finished job 4.
4 of 14 steps (29%) done
Select jobs to execute...

[Tue Sep 23 11:37:00 2025]
rule Computational_ture_enh_signal:
    input: data/CHIPPROJ/bam_bwfile/bambw_list.yaml, data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb.bed
    output: data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb_matrix.gz, data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb_signal.tab
    jobid: 5
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb_signal.tab, data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb_matrix.gz; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb.bed
    resources: tmpdir=/tmp


[Tue Sep 23 11:37:00 2025]
rule Enhancer_plot:
    input: data/INTEGRATEDPROJ/script/Enhancer/config.yaml, data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb.bed, data/CHIPPROJ/Macs2/group_matrix.txt
    output: data/INTEGRATEDPROJ/Enhancer/file/mESC_18h_DOX_all_peaks.bed, data/INTEGRATEDPROJ/Enhancer/file/mESC_12h_DOX_all_peaks.bed, data/INTEGRATEDPROJ/Enhancer/file/mESC_18h_DOX_down_peaks.bed, data/INTEGRATEDPROJ/Enhancer/file/mESC_12h_DOX_down_peaks.bed, data/INTEGRATEDPROJ/Enhancer/file/mESC_18h_DOX_up_peaks.bed, data/INTEGRATEDPROJ/Enhancer/file/mESC_12h_DOX_up_peaks.bed, data/INTEGRATEDPROJ/Enhancer/picture/RNA_ChIP_col_plot_same_direction.pdf, data/INTEGRATEDPROJ/Enhancer/picture/common_genes_volcano_plot.pdf, data/INTEGRATEDPROJ/Enhancer/picture/common_up_genes_venn_diagram.pdf, data/INTEGRATEDPROJ/Enhancer/picture/common_down_genes_venn_diagram.pdf, data/INTEGRATEDPROJ/Enhancer/file/GO_enrich_common_gene.csv, data/INTEGRATEDPROJ/Enhancer/file/KEGG_GSEA_common_gene.csv, data/INTEGRATEDPROJ/Enhancer/picture/KEGG_GSEA_Top10_Multipage.pdf
    jobid: 7
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/file/GO_enrich_common_gene.csv, data/INTEGRATEDPROJ/Enhancer/file/KEGG_GSEA_common_gene.csv; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb.bed
    resources: tmpdir=/tmp

[Tue Sep 23 11:37:10 2025]
Finished job 5.
5 of 14 steps (36%) done
Select jobs to execute...

[Tue Sep 23 11:37:10 2025]
rule plot_ture_enh_signal:
    input: data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb_matrix.gz
    output: data/INTEGRATEDPROJ/Enhancer/picture/Ture_enh_gene_within_1mb_profile.pdf
    jobid: 6
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/picture/Ture_enh_gene_within_1mb_profile.pdf; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb_matrix.gz
    resources: tmpdir=/tmp

[Tue Sep 23 11:37:13 2025]
Finished job 6.
6 of 14 steps (43%) done
[Tue Sep 23 11:38:15 2025]
Finished job 7.
7 of 14 steps (50%) done
Select jobs to execute...

[Tue Sep 23 11:38:15 2025]
rule Network_construction:
    input: data/INTEGRATEDPROJ/Enhancer/file/GO_enrich_common_gene.csv
    output: data/INTEGRATEDPROJ/Enhancer/file/GO_network.graphml
    jobid: 8
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/file/GO_network.graphml; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/file/GO_enrich_common_gene.csv
    resources: tmpdir=/tmp


[Tue Sep 23 11:38:15 2025]
rule Motif_tf_Enhancer:
    input: data/INTEGRATEDPROJ/script/Enhancer/config.yaml, data/CHIPPROJ/bam_bwfile/bambw_list.yaml, data/INTEGRATEDPROJ/Enhancer/file/KEGG_GSEA_common_gene.csv
    output: data/INTEGRATEDPROJ/Enhancer/file/Enhancer_both_up_genes_target_seqs.fasta, data/INTEGRATEDPROJ/Enhancer/file/Enhancer_both_down_genes_target_seqs.fasta, data/INTEGRATEDPROJ/Enhancer/file/TF_motif_network_up.txt, data/INTEGRATEDPROJ/Enhancer/file/TF_motif_network_down.txt, data/INTEGRATEDPROJ/Enhancer/file/TF_gene_mapping_up.txt, data/INTEGRATEDPROJ/Enhancer/file/TF_gene_mapping_down.txt, data/INTEGRATEDPROJ/Enhancer/file/Enhancer_both_up_genes_matrix.gz, data/INTEGRATEDPROJ/Enhancer/file/Enhancer_both_up_genes_signal.tab, data/INTEGRATEDPROJ/Enhancer/file/Enhancer_both_down_genes_matrix.gz, data/INTEGRATEDPROJ/Enhancer/file/Enhancer_both_down_genes_signal.tab, data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_up_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_down_genes_plotProfile.pdf
    jobid: 9
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_down_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_up_genes_plotProfile.pdf; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/file/KEGG_GSEA_common_gene.csv
    resources: tmpdir=/tmp

[Tue Sep 23 11:38:17 2025]
Finished job 8.
8 of 14 steps (57%) done
[Tue Sep 23 11:45:56 2025]
Finished job 9.
9 of 14 steps (64%) done
Select jobs to execute...

[Tue Sep 23 11:45:56 2025]
rule extr_down_gene_enriched_motifs:
    input: data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_up_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_down_genes_plotProfile.pdf
    output: data/INTEGRATEDPROJ/Enhancer/file/Motif_result_down_list.txt
    jobid: 11
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/file/Motif_result_down_list.txt; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_down_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_up_genes_plotProfile.pdf
    resources: tmpdir=/tmp


[Tue Sep 23 11:45:56 2025]
rule extr_up_gene_enriched_motifs:
    input: data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_up_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_down_genes_plotProfile.pdf
    output: data/INTEGRATEDPROJ/Enhancer/file/Motif_result_up_list.txt
    jobid: 10
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/file/Motif_result_up_list.txt; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_down_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_up_genes_plotProfile.pdf
    resources: tmpdir=/tmp

[Tue Sep 23 11:45:58 2025]
Finished job 10.
10 of 14 steps (71%) done
Select jobs to execute...

[Tue Sep 23 11:45:58 2025]
rule TF_motif_plot_up:
    input: data/INTEGRATEDPROJ/Enhancer/file/Motif_result_up_list.txt
    output: data/INTEGRATEDPROJ/Enhancer/picture/TF_up_gene_heatmap.pdf
    jobid: 12
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/picture/TF_up_gene_heatmap.pdf; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/file/Motif_result_up_list.txt
    resources: tmpdir=/tmp

[Tue Sep 23 11:45:58 2025]
Finished job 11.
11 of 14 steps (79%) done
Select jobs to execute...

[Tue Sep 23 11:45:58 2025]
rule TF_motif_plot_down:
    input: data/INTEGRATEDPROJ/Enhancer/file/Motif_result_down_list.txt
    output: data/INTEGRATEDPROJ/Enhancer/picture/TF_down_gene_heatmap.pdf
    jobid: 13
    reason: Missing output files: data/INTEGRATEDPROJ/Enhancer/picture/TF_down_gene_heatmap.pdf; Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/file/Motif_result_down_list.txt
    resources: tmpdir=/tmp

[Tue Sep 23 11:46:04 2025]
Finished job 13.
12 of 14 steps (86%) done
[Tue Sep 23 11:46:05 2025]
Finished job 12.
13 of 14 steps (93%) done
Select jobs to execute...

[Tue Sep 23 11:46:05 2025]
localrule all:
    input: data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb.bed, data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb.bed, data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb_signal.tab, data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb_signal.tab, data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb.bed, data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb_signal.tab, data/INTEGRATEDPROJ/Enhancer/picture/Ture_enh_gene_within_1mb_profile.pdf, data/INTEGRATEDPROJ/Enhancer/file/GO_enrich_common_gene.csv, data/INTEGRATEDPROJ/Enhancer/file/KEGG_GSEA_common_gene.csv, data/INTEGRATEDPROJ/Enhancer/file/GO_network.graphml, data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_up_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_down_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Enhancer/file/Motif_result_up_list.txt, data/INTEGRATEDPROJ/Enhancer/file/Motif_result_down_list.txt, data/INTEGRATEDPROJ/Enhancer/picture/TF_up_gene_heatmap.pdf, data/INTEGRATEDPROJ/Enhancer/picture/TF_down_gene_heatmap.pdf
    jobid: 0
    reason: Input files updated by another job: data/INTEGRATEDPROJ/Enhancer/picture/Ture_enh_gene_within_1mb_profile.pdf, data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb_signal.tab, data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_up_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb_signal.tab, data/INTEGRATEDPROJ/Enhancer/file/Motif_result_down_list.txt, data/INTEGRATEDPROJ/Enhancer/file/GO_network.graphml, data/INTEGRATEDPROJ/Enhancer/picture/Enhancer_both_down_genes_plotProfile.pdf, data/INTEGRATEDPROJ/Enhancer/picture/TF_up_gene_heatmap.pdf, data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb_signal.tab, data/INTEGRATEDPROJ/Enhancer/file/Motif_result_up_list.txt, data/INTEGRATEDPROJ/Enhancer/file/Ture_enh_gene_within_1mb.bed, data/INTEGRATEDPROJ/Enhancer/file/random_enh_gene_within_1mb.bed, data/INTEGRATEDPROJ/Enhancer/file/GO_enrich_common_gene.csv, data/INTEGRATEDPROJ/Enhancer/file/enh_gene_within_1mb.bed, data/INTEGRATEDPROJ/Enhancer/picture/TF_down_gene_heatmap.pdf, data/INTEGRATEDPROJ/Enhancer/file/KEGG_GSEA_common_gene.csv
    resources: tmpdir=/tmp

[Tue Sep 23 11:46:05 2025]
Finished job 0.
14 of 14 steps (100%) done
Complete log: .snakemake/log/2025-09-23T112800.224147.snakemake.log
